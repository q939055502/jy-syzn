# 规范日期信息更新计划

## 1. 任务目标

从数据库中获取各条规范的生效日期和失效日期，并将这些信息更新到 `d:\Projects\jy_syzn\规范.csv` 文件中。

## 2. 数据来源分析

### 2.1 当前CSV文件状态

* 包含61条规范记录

* 只有前3条规范（GB/T 175-2024、GB/T 50081-2019、GB/T 1346-2011）有生效日期

* 所有规范的失效日期为空

* 其他规范的生效日期也为空

### 2.2 数据库数据状态

* 数据库中存储了63条规范记录

* 包含了原有的2条数据和从CSV导入的61条数据

* 数据库中的生效日期和失效日期信息可能比CSV文件更完整

## 3. 实现方案

### 3.1 创建更新脚本

创建 `update_standard_dates.py` 脚本，用于：

1. 从互联网中获取所有规范的生效日期和失效日期
2. 读取CSV文件
3. 将日期信息更新到CSV文件中
4. 保存更新后的CSV文件

### 3.2 脚本主要步骤

1. **导入必要库**：

   * pandas：用于读取和写入CSV文件

2. **连接数据库**：

   * 使用项目已有的数据库连接配置

   * 创建数据库会话

   * 查询所有规范的标准编号、生效日期和失效日期

3. **读取CSV文件**：

   * 使用pandas读取CSV文件

   * 保留原有数据结构和格式

4. **更新日期信息**：

   * 遍历CSV文件中的每条记录

   * 根据规范编号从数据库中查找对应的日期信息

   * 如果找到匹配的日期信息，更新CSV文件中的生效日期和失效日期

   * 保持其他字段不变

5. **保存更新后的CSV文件**：

   * 将更新后的数据写回到原CSV文件

   * 保持原有的列顺序和格式

### 3.3 脚本代码结构

```python
# 导入必要库
import pandas as pd
from config import config
from app.extensions import init_db
from app.models.detection.detection_standard import DetectionStandard

# 主函数
def main():
    # 连接数据库并查询规范日期信息
    # 读取CSV文件
```

