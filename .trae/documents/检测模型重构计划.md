# 检测模型重构计划

## 一、重构目标
按照"分类--检测对象--检测项目--检测参数"的结构对模型进行重构，清理冗余代码和字段，确保数据模型符合检测行业业务逻辑。

## 二、重构步骤

### 1. 创建检测对象模型
- 创建`app/models/detection/detection_object.py`文件
- 定义`DetectionObject`模型，包含核心字段
- 建立与分类和检测项目的关联关系

### 2. 修改现有模型
- **Category模型**：
  - 添加与检测对象的一对多关系
  - 移除与检测项目的直接关联

- **DetectionItem模型**：
  - 将`category_id`外键替换为`object_id`
  - 修改唯一约束
  - 更新关系定义

- **DetectionParam模型**：
  - 保留`material_name`字段作为检测参数的属性
  - 检查并更新关联关系

### 3. 更新模型关联和初始化文件
- 更新`app/models/detection/__init__.py`，添加`DetectionObject`导出
- 更新`app/models/__init__.py`，添加`DetectionObject`导出
- 检查`associations.py`，确保关联表定义正确

### 4. 清理冗余代码和字段
- 删除不再使用的字段和关系
- 确保模型定义简洁清晰

### 5. 更新初始化脚本
- 修改`d:rojectsy_syzncriptnit_all.py`
  - 添加`DetectionObject`导入
  - 更新数据初始化顺序：分类→检测对象→检测项目→检测参数
  - 更新数据创建逻辑，确保关联关系正确
  - 更新数据验证逻辑

### 6. 测试和验证
- 运行初始化脚本，检查是否有错误
- 如果出现错误，修复后重新运行
- 验证数据库表结构和数据是否正确

## 三、预期结果
- 模型结构符合"分类--检测对象--检测项目--检测参数"的设计
- 数据库表结构正确，关联关系清晰
- 初始化脚本能够成功运行，生成正确的数据
- 系统能够正常运行，无冗余代码和字段

## 四、风险和注意事项
- 确保数据迁移过程中不会丢失重要数据
- 注意外键约束，避免删除表时出现错误
- 确保所有关联关系定义正确，避免循环依赖
- 测试时要全面，确保所有功能都能正常运行