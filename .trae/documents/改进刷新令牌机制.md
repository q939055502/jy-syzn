## 改进刷新令牌机制

### 1. 问题分析
当前刷新令牌机制存在安全隐患：旧的刷新令牌在刷新后仍然有效，增加了被滥用的风险。

### 2. 改进方案
采用**刷新令牌轮转机制**，即每次使用刷新令牌获取新访问令牌时，同时生成新的刷新令牌，使旧刷新令牌失效。

### 3. 实现步骤

#### 3.1 修改响应模型
- 更新 `AccessTokenData` 模型，添加 `refresh_token` 字段

#### 3.2 修改刷新令牌端点
- 验证旧刷新令牌
- 生成新访问令牌
- 生成新刷新令牌
- 将旧刷新令牌添加到黑名单
- 更新Redis缓存
- 返回新的访问令牌和刷新令牌

#### 3.3 更新API文档
- 修改 `/api/auth/refresh` 端点的文档
- 添加新的响应字段说明

### 4. 预期效果
- 每次刷新令牌时，旧的刷新令牌自动失效
- 降低刷新令牌被滥用的风险
- 符合OAuth 2.0最佳实践

### 5. 代码修改点
1. `app/routes/auth.py`：
   - 修改 `AccessTokenData` 模型
   - 更新 `refresh_access_token` 方法实现

2. `d:\Projects\jy_syzn\API_DOCUMENTATION.md`：
   - 更新刷新令牌端点的文档

### 6. 安全性考虑
- 旧刷新令牌会被添加到黑名单，确保无法重复使用
- 新刷新令牌采用与原刷新令牌相同的过期时间
- 整个过程采用原子操作，确保令牌状态一致性