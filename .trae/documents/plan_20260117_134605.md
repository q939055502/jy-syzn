# 检测指南合并到检测参数的改造方案

## 1. 模型改造

### 1.1 修改检测参数模型 (`detection_param.py`)
- 新增字段：
  - `sampling_batch`：组批规则
  - `sampling_require`：取样要求
  - `required_info`：所需信息
  - `report_time`：报告时间
  - `price_note`：价格说明
  - `sample_processing_fee`：样品加工费（字符类型，带单位）
  - `sample_image_path`：取样方法示意图路径
  - `sample_video_path`：取样方法视频路径
- 新增多对多关系：
  - 与检测规范（`DetectionStandard`）的关联，通过新中间表 `DetectionParamStandard`
  - 与委托单模板（`DelegationFormTemplate`）的关联，通过新中间表 `DetectionParamTemplate`
- 删除与检测指南（`DetectionGuide`）的关联

### 1.2 删除检测指南相关模型和中间表
- 删除 `DetectionGuide` 模型
- 删除中间表：
  - `DetectionParamGuide`（检测参数与检测指南关联表）
  - `DetectionGuideStandard`（检测指南与检测规范关联表）

### 1.3 修改检测规范模型 (`detection_standard.py`)
- 移除与 `DetectionGuide` 的关联关系

## 2. 初始化脚本修改 (`script/init_all.py`)
- 删除检测指南相关的初始化代码
- 修改检测参数初始化，添加新字段数据
- 更新清理现有数据逻辑，移除检测指南相关表的清理

## 3. 文档更新

### 3.1 更新模型说明文件 (`模型说明.md`)
- 修改表关系图，移除检测指南相关内容
- 更新模型关系说明，添加检测参数与检测规范、委托单模板的关联关系
- 更新模型文件列表，移除检测指南模型

### 3.2 更新API接口说明 (`API接口说明.md`)
- 移除所有检测指南相关接口
- 更新检测参数接口，添加新字段的请求和响应示例

## 4. 数据库重建
- 删除现有数据库
- 重新创建数据库和表结构
- 运行更新后的初始化脚本

## 5. 测试
- 运行初始化脚本，验证数据创建成功
- 检查数据库表结构，确认所有修改正确应用

## 具体实现步骤

1. 修改 `associations.py`，删除检测指南相关中间表，添加新的中间表
2. 修改 `detection_standard.py`，移除与检测指南的关联
3. 修改 `detection_param.py`，添加新字段和关联关系
4. 删除 `detection_guide.py` 模型文件
5. 修改 `script/init_all.py`，更新初始化逻辑
6. 更新 `模型说明.md` 文档
7. 更新 `API接口说明.md` 文档
8. 运行脚本重建数据库和初始化数据
9. 测试验证

## 预期效果

- 检测参数模型包含所有必要的检测指南信息
- 移除冗余的检测指南模型，简化数据结构
- 保持与检测规范和委托单模板的关联关系
- API接口更简洁，减少前端调用复杂度
- 数据初始化正常，所有关联关系正确建立