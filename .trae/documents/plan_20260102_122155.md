## 问题分析

当前认证流程存在以下问题：
- 登录时，`UserDAL.authenticate_user` 直接使用 `is_active=True` 条件查询用户
- 当用户不存在或被禁用时，都会返回 `None`
- 最终登录接口返回的错误信息都是 "用户名或密码错误"
- 用户无法区分是用户名/密码错误还是账号被禁用

## 改进方案

### 1. 修改认证流程

**修改文件**：`app/services/user/user_service.py`
- 修改 `authenticate_user` 方法：
  - 先通过 `get_by_username` 获取用户（不限制 `is_active`）
  - 然后检查用户状态和密码
  - 返回不同的结果标识不同的错误情况

### 2. 改进登录接口错误处理

**修改文件**：`app/routes/auth.py`
- 修改 `login_for_access_token` 函数：
  - 根据认证结果返回不同的错误信息
  - 当用户被禁用时，返回 "账号已被禁用"
  - 当用户名或密码错误时，返回 "用户名或密码错误"

### 3. 确保令牌验证时的处理

**已完成**：在之前的任务中，我们已经实现了令牌验证时检查用户 `is_active` 状态的逻辑

## 实现步骤

1. 更新 `UserService.authenticate_user` 方法，区分用户不存在、密码错误和用户被禁用的情况
2. 更新 `login_for_access_token` 函数，根据认证结果返回不同的错误信息
3. 测试改进后的功能，确保：
   - 用户名/密码错误时返回正确提示
   - 账号被禁用时返回正确提示
   - 正常登录时仍能成功获取令牌

## 预期效果

- 登录时，根据不同情况返回更友好的错误提示
- 用户可以清楚地区分是用户名/密码错误还是账号被禁用
- 提高用户体验，减少用户困惑
- 增强系统的安全性和透明度

## 技术实现

- 使用结构化的返回值标识不同的认证结果
- 在登录接口中根据认证结果返回不同的错误信息
- 保持与现有代码结构的兼容性
- 确保修改后不会影响其他功能